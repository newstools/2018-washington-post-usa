A D.C. federal judge has delivered the toughest blow yet to Trump administration efforts to end deportation protections for young undocumented immigrants, ordering the government to continue the Obama-era program and — for the first time since announcing it would end — reopen it to new applicants. U.S. District Judge John D. Bates on Tuesday called the government’s decision to end the Deferred Action for Childhood Arrivals program “virtually unexplained” and therefore “unlawful.” However, he stayed his ruling for 90 days to give the Department of Homeland Security a chance to provide more solid reasoning for ending the program. Bates is the third judge to rule against Trump administration attempts to rescind DACA, which provides two-year, renewable work permits and deportation protections for about 690,000 “dreamers,” undocumented immigrants brought to this country as children. In his decision, Bates said the decision to phase out the program starting in March “was arbitrary and capricious because the Department failed adequately to explain its conclusion that the program was unlawful.” “Each day that the agency delays is a day that aliens who might otherwise be eligible for initial grants of DACA benefits are exposed to removal because of an unlawful agency action,” Bates wrote. Federal judges in California and New York have also blocked the administration’s plans on those grounds, and ordered the administration to renew work permits for immigrants enrolled in the program. But the ruling by Bates, an appointee of President George W. Bush, is far more expansive: If the government does not come up with a better explanation within 90 days, he will rescind the government memo that terminated the program and require Homeland Security to enroll new applicants, as well. Thousands could be eligible to apply. The cases were brought by the NAACP, Microsoft, Princeton University and a student. “We are pleased and gratified . . . but we’re not out of the woods yet,” said Bradford Berry, general counsel for the NAACP. “The government still has an opportunity to try to save their rescission of the program.” Princeton University President Christopher L. Eisgruber added that “While the decision does not fully resolve the uncertainty facing DACA beneficiaries, it unequivocally rejects the rationale the government has offered for ending the program and makes clear that the DHS acted arbitrarily and capriciously.” Brad Smith, the president of Microsoft, said, “We hope this decision will help provide new incentive for the legislative solution the country and these individuals so clearly deserve. As the business community has come to appreciate, a lasting solution for the country’s dreamers is both an economic imperative and a humanitarian necessity.” The Trump administration said it is reviewing the decision. In a statement, the Justice Department pointed out that a similar Obama-era program for immigrant parents failed to survive a court challenge, and said ending DACA was part of its efforts to protect the border and enforce the rule of law. “Today’s order doesn’t change the Department of Justice’s position on the facts: DACA was implemented unilaterally after Congress declined to extend benefits to this same group of illegal aliens,” spokesman Devin O’Malley said in a statement. “The Justice Department will continue to vigorously defend this position.” A federal judge in Maryland recently ruled in favor of the government in a different DACA case. The Trump administration says it decided to end DACA because Texas and other states had threatened to sue over it, and the government believed the program would not survive a court challenge. Bates ruled that the government’s “meager legal reasoning” — and the threat of a lawsuit — did not justify terminating the program. Congress failed to pass legislation this year protecting DACA recipients and other dreamers. Trump had hoped to use the young immigrants as a bargaining chip in the last round of budget negotiations, offering legal residency for them in exchange for money for a border wall and strict new immigration limits. After negotiations collapsed, he declared DACA “dead.” His administration this year has renewed more than 55,000 work permits for immigrants enrolled in the program, as the courts required. The program has transformed the lives of hundreds of thousands of immigrants, allowing them to get driver’s licenses, qualify for in-state tuition, buy homes and attend college and graduate school. They must meet educational and residency requirements and cannot have serious criminal records. Read more: Federal judge weighs ordering administration to restart DACA Undocumented and old enough for DACA, but too late to apply With 3 months left in med school, her career may be slipping away